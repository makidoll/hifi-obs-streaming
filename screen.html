<!DOCTYPE html>
<html>
	<head>
		<title>Stream</title>
		<link href="https://fonts.googleapis.com/css?family=Roboto:700" rel="stylesheet">
		<style type="text/css">
			* { margin: 0; }

			body {
				background: #1d1f21;
				overflow: hidden;
				width: 100vw;
				height: 100vh;
				font-family: "Roboto", sans-serif;
			}

			canvas {
				position: fixed; margin: auto;
				top: 0; left: 0; right: 0; bottom: 0;
				z-index: 1000;
				width: 0; height: 0;
			}

			#text {
				position: fixed; margin: auto;
				top: 0; left: 0; right: 0; bottom: 0;
				height: 80px;
				z-index: 100;
				color: #fff;
				text-align: center;
			}
		</style>
	</head>
	<body>
		<div id="text">
			<p style="font-weight: 700; font-size: 64px;">Stream is offline</p>
		</div>
		<canvas></canvas>
		<script type="text/javascript" src="https://jsmpeg.com/jsmpeg.min.js"></script>
		<script type="text/javascript">
			var _GET = {};
			window.location.search.substr(1).split("&").forEach(function(e, i) {
				let param = e.split("=");
				_GET[param[0]] = param[1];
			});

			var canvas = document.querySelector("canvas");
			let ratio = 1920/1080;

			function resizeCanvas() {
				let width = document.body.clientWidth;
				let height = document.body.clientHeight;
				if (width<height*ratio) {
					canvas.style.width = width+"px";
					canvas.style.height = "initial";
				} else {
					canvas.style.width = "initial";
					canvas.style.height = height+"px";
				}
			}

			var loaded = false;
			window.addEventListener("resize", function() {
				if (!loaded) return;
				resizeCanvas()
			});

			var player = new JSMpeg.Player(_GET.ws, {
				canvas: canvas,
				audio: false,
				video: true,
				videoBufferSize: 1024*1024,
				onVideoDecode: function() {
					if (loaded) return;
					resizeCanvas();
					loaded = true;
				}
			});
		</script>
	</body>
</html>